"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3453],{3453:(A,m,a)=>{a.r(m),a.d(m,{SignupPage:()=>I});var g=a(467),e=a(3953),v=a(177),o=a(4341),p=a(8573),f=a(1832),C=a(1868),l=a(2700),P=a(5079),u=a(5873),_=a(3273),M=a(4796),O=a(1730);const E=(n,s)=>s.id,F=()=>["/auth/login"];function x(n,s){if(1&n&&e.nrm(0,"ion-progress-bar",3),2&n){const i=e.XpG();e.Y8G("value",i.progress)}}function y(n,s){if(1&n&&(e.j41(0,"ion-select-option",3),e.EFF(1),e.k0s()),2&n){const i=s.$implicit;e.Y8G("value",i.text),e.R7$(),e.JRh(i.text)}}function b(n,s){1&n&&(e.j41(0,"div",14)(1,"label",20),e.EFF(2," Addresse email non valide"),e.k0s()())}function T(n,s){1&n&&(e.j41(0,"div",14)(1,"label",20),e.EFF(2," Mot de pass non valid et doit avoir une longeur de 8 charactere et dois contenir au moin un charactere special ou un emajuscule"),e.k0s()())}function D(n,s){1&n&&(e.j41(0,"div",14)(1,"label",20),e.EFF(2," fomulaire d'inscription invalide veuillez remplire tous les champs "),e.k0s()())}function S(n,s){if(1&n){const i=e.RV6();e.j41(0,"form",5),e.bIt("ngSubmit",function(){e.eBV(i);const r=e.XpG();return e.Njj(r.onSubmit())}),e.j41(1,"div",6)(2,"div",7)(3,"ion-item",8)(4,"ion-select",9),e.bIt("ionChange",function(r){e.eBV(i);const c=e.XpG();return e.Njj(c.handleSelectChange(r))}),e.Z7z(5,y,2,2,"ion-select-option",3,E),e.k0s()()(),e.j41(7,"div",7),e.nrm(8,"input",10)(9,"ion-icon",11),e.k0s(),e.j41(10,"div",7),e.nrm(11,"input",12)(12,"ion-icon",13),e.k0s(),e.DNE(13,b,3,0,"div",14)(14,T,3,0,"div",14)(15,D,3,0,"div",14),e.j41(16,"ion-button",15),e.EFF(17,"register"),e.k0s(),e.j41(18,"div",16)(19,"a",17),e.EFF(20,"forgot password? "),e.k0s()()(),e.j41(21,"div",18)(22,"p"),e.EFF(23," already member?"),e.j41(24,"a",19),e.EFF(25,"signin now"),e.k0s()()()()}if(2&n){const i=e.XpG();e.Y8G("formGroup",i.registerForm),e.R7$(5),e.Dyx(i.availableCategories()),e.R7$(3),e.Y8G("formControl",i.registerForm.controls.email),e.R7$(5),e.vxM(i.emailIsInvalid?13:-1),e.R7$(),e.vxM(i.passwordIsInvalid?14:-1),e.R7$(),e.vxM(i.formSubmitted&&i.registerForm.invalid?15:-1),e.R7$(9),e.Y8G("routerLink",e.lJ4(6,F))}}let I=(()=>{var n;class s{constructor(){this.firestore=(0,_.aU)(),this.signalementsService=(0,e.WQX)(O.W),this.router=(0,e.WQX)(p.Ix),this.formSubmitted=!1,this.isFetching=(0,e.vPA)(!1),this.authService=(0,e.WQX)(M.u),this.availableCategories=(0,e.vPA)(f.L),this.choosedCategorie=(0,e.vPA)({}),this.alertController=(0,e.WQX)(l.hG),this.toastController=(0,e.WQX)(l.K_),this.progress=0,this.destroyRef=(0,e.WQX)(e.abz),this.registerForm=new o.gE({email:new o.MJ("",{validators:[o.k0.required,o.k0.email]}),password:new o.MJ("",{validators:[o.k0.required,o.k0.minLength(8),C.$]}),categorie:new o.MJ("",{validators:[o.k0.required]})}),(0,P.a)({personOutline:u.wAZ,lockClosedOutline:u.eso,chevronForward:u.fZ}),setInterval(()=>{this.progress+=.01,this.progress>1&&setTimeout(()=>{this.progress=0},1e3)},50)}get emailIsInvalid(){return this.registerForm.controls.email.touched&&this.registerForm.controls.email.dirty&&this.registerForm.controls.email.invalid}get passwordIsInvalid(){return this.registerForm.controls.password.touched&&this.registerForm.controls.password.dirty&&this.registerForm.controls.password.invalid}onSubmit(){var t=this;return(0,g.A)(function*(){if(t.formSubmitted=!0,!t.registerForm.invalid){t.isFetching.set(!0);try{const r=yield t.authService.register(t.registerForm.value.email,t.registerForm.value.password);if(r){const c=(0,_.H9)(t.firestore,`users/${r.uid}`);yield(0,_.BN)(c,{email:t.registerForm.value.email,categorie:t.registerForm.value.categorie}),yield t.showToast("Success ! utilisateur cr\xe9e !"),yield t.signalementsService.loadSignalements(),t.router.navigate(["/signalements/liste"]),console.log("my response:",r)}}catch(r){console.log(r),yield t.showToast("L'utilisateur existe d\xe9j\xe0.")}finally{t.isFetching.set(!1)}}})()}handleSelectChange(t){var r=this;return(0,g.A)(function*(){const c=t.detail.value;var k;yield(yield r.alertController.create({header:"Confirmation",message:`Enter the code to confirm the category: ${c}`,inputs:[{name:"code",type:"password",placeholder:"Enter code"}],buttons:[{text:"Cancel",role:"cancel",handler:()=>{console.log("Alert canceled")}},{text:"OK",role:"confirm",handler:(k=(0,g.A)(function*(h){const d=f.L.find(R=>R.uniqueCode===h.code);!d||null!=d&&d.created?(r.registerForm.controls.categorie.setValue(""),yield r.showToast("Vous n'avez pas le droit de choisir cette cat\xe9gorie.")):r.registerForm.controls.categorie.setValue(c)}),function(d){return k.apply(this,arguments)})}]})).present()})()}showToast(t){var r=this;return(0,g.A)(function*(){(yield r.toastController.create({message:t,duration:2e3,position:"top"})).present()})()}ngOnInit(){}}return(n=s).\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.VBU({type:n,selectors:[["app-signup"]],standalone:!0,features:[e.aNF],decls:7,vars:1,consts:[[1,"header"],[1,"title"],[1,"subTitle"],[3,"value"],[3,"formGroup"],[3,"ngSubmit","formGroup"],["div","",1,"ion-padding"],[1,"input-container"],[2,"width","100%","padding","0","position","relative"],["aria-label","Fruit","interface","action-sheet","placeholder","Selectionner votre categorie","formControlName","categorie","name","categorie","id","present-alert",1,"categories",3,"ionChange"],["placeholder","username","name","email",1,"input",3,"formControl"],["name","person-outline",1,"input-icon"],["placeholder","password","name","password","type","password","formControlName","password",1,"input"],["name","lock-closed-outline",1,"input-icon"],[1,"error-message"],["type","submit","expand","block"],[1,"forgotPassword"],["routerLink","/auth/password-reset",2,"color","#ffc33f"],[1,"signinLink"],[2,"color","#ffc33f",3,"routerLink"],[1,"show"]],template:function(t,r){1&t&&(e.j41(0,"div",0)(1,"ion-title",1),e.EFF(2,"Welcome"),e.k0s(),e.j41(3,"p",2),e.EFF(4,"sign up to access your account"),e.k0s()(),e.DNE(5,x,1,1,"ion-progress-bar",3)(6,S,26,7,"form",4)),2&t&&(e.R7$(5),e.vxM(r.isFetching()?5:6))},dependencies:[l.FH,l.Jm,l.iq,l.uz,l.BC,l.Ip,l.Nm,v.MD,p.Wk,o.YN,o.qT,o.me,o.BC,o.cb,o.X1,o.l_,o.j4,o.JD],styles:['@charset "UTF-8";.input-container[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;margin-bottom:1rem}input[_ngcontent-%COMP%]{padding:10px;border:3px solid transparent;width:100%;box-sizing:border-box;padding:1.2rem;border-radius:.9rem;background-color:#f1f1f1}input[_ngcontent-%COMP%]   [_ngcontent-%COMP%]::placeholder{text-align:left}input[_ngcontent-%COMP%]:focus{border-color:#51c2d5;outline:none}.input-icon[_ngcontent-%COMP%]{position:absolute;z-index:999;right:15px;font-size:1.5rem;top:50%;transform:translateY(-50%)}ion-item[_ngcontent-%COMP%]{--background: #f1f1f1;border-radius:10px;margin-bottom:16px}.input.ng-touched[_ngcontent-%COMP%]{border:none;transition:var(--background) .2s ease;background:#ffdede;animation:_ngcontent-%COMP%_opa .5s ease-in-out}@keyframes _ngcontent-%COMP%_opa{0%,to{transform:translate(0)}25%{transform:translate(-15px)}50%{transform:translate(15px)}75%{transform:translate(-15px)}}.header[_ngcontent-%COMP%]{margin-top:100px;margin-bottom:80px;text-align:center}.header[_ngcontent-%COMP%]   .subTitle[_ngcontent-%COMP%]{color:gray;font-size:.9rem}.header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:2rem}.signupLink[_ngcontent-%COMP%]{display:flex;margin:auto;flex-direction:row;align-content:center;position:absolute;left:0;bottom:0;width:80%;right:0}.signupLink[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem}.signupLink[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;margin-left:.5rem}ion-content[_ngcontent-%COMP%]{z-index:999}.error-message[_ngcontent-%COMP%]{color:red;font-size:.9rem;margin-top:10px;text-align:center;opacity:0;animation:_ngcontent-%COMP%_fadeIn .5s ease-in-out forwards}.error-message[_ngcontent-%COMP%]   .show[_ngcontent-%COMP%]{opacity:1;animation:_ngcontent-%COMP%_fadeIn .5s ease-in-out forwards}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}']}),s})()}}]);